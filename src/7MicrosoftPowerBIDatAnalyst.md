In this article, contains info about #MicrosoftPowerBIDataAnalyst and get prepared about for Exam PL-300.

Foreword:

<div data-node-type="callout">
<div data-node-type="callout-emoji">ðŸ“–</div>
<div data-node-type="callout-text">The entire content is owned by Microsoft, and I am logging for practice and it is for educational purposes only.</div>
</div>

# Overview:

This course covers the various methods and best practices that are in line with business and technical requirements for

* modeling,
    
* visualizing, and
    
* analyzing data with Power BI.
    

The course will show how to access and process data from a range of data sources including both relational and non-relational sources.

Finally, this course will also discuss how to manage and deploy reports and dashboards for sharing and content distribution.

As a candidate for this "*Microsoft Power BI Data Analyst*" certification, you should deliver actionable insights by working with available data and applying domain expertise.

You should:

* Provide meaningful business value through easy-to-comprehend data visualizations.
    
* Enable others to perform self-service analytics.
    
* Deploy and configure solutions for consumption.
    

As a Power BI data analyst, you work closely with business stakeholders to identify business requirements.

You collaborate with enterprise data analysts and data engineers to identify and acquire data.

You use Power BI to:

* Transform the data.
    
* Create data models.
    
* Visualize data.
    
* Share assets.
    

You should be proficient at using Power Query and writing expressions by using Data Analysis Expressions (DAX).

You know how to assess data quality. Plus, you understand data security, including row-level security and data sensitivity.

# **Skills measured**

* Prepare the data
    
* Model the data
    
* Visualize and analyze the data
    
* Deploy and maintain assets
    

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 17 |  |

# I. Module 1 Discover data analysis

![](https://learn.microsoft.com/en-us/training/achievements/data-analytics-and-microsoft.svg)

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 1/17 | Discover data analysis |

Would you like to explore the journey of a data analyst and learn how a data analyst tells a story with data?

### **1\. Introduction**

> As a data analyst, you are on a journey.

With data and information as the most strategic asset of a business, the underlying challenge that organizations have today is understanding and using their data to positively effect change within the business.

Businesses continue to struggle to use their data in a meaningful and productive way, which impacts their ability to act.

You need to be able to look at the data and facilitate trusted business decisions. Then, you need the ability to look at metrics and clearly understand the meaning behind those metrics.

Data analysis exists to help overcome these challenges and pain points, ultimately assisting businesses in finding insights and uncovering hidden value in troves of data through storytelling.

As you read on, you will learn how to use and apply analytical skills to go beyond a single report and help impact and influence your organization by telling stories with data and driving that data culture.

### **2\. Overview of data analysis**

> Data analysis is the process of identifying, cleaning, transforming, and modeling data to discover meaningful and useful information.

The data is then crafted into a story through reports for analysis to support the critical decision-making process.

While the process of data analysis focuses on the tasks of cleaning, modeling, and visualizing data, the concept of data analysis and its importance to business should not be understated. To analyze data, core components of analytics are divided into the following categories:

* Descriptive - key performance indicators (KPIs) - return on investment (ROI), organization's sales and financial data.
    
* Diagnostic - questions about why events happened
    
* Predictive - questions about what will happen in the future
    
* Prescriptive - questions about which actions should be taken to achieve a goal or target.
    
* Cognitive - a self-learning feedback loop.
    

> As the amount of data grows, so does the need for data analysts. A data analyst knows how to organize information and distill it into something relevant and comprehensible. A data analyst knows how to gather the right data and what to do with it, in other words, making sense of the data in your data overload.

### **3\. Roles in data**

* Business analyst
    
* Data analyst
    
* Data engineer
    
* Data scientist
    
* Database administrator
    

### **4\. Tasks of a data analyst**

* Data preparation - profiling, cleaning, and transforming your data to get it ready to model and visualize.
    
* Data modeling - determining how your tables are related to each other.
    
* visualization - report should tell a compelling story about that data.
    
* Analyze - find insights, identify patterns and trends, predict outcomes, and then communicate those insights.
    
* Manage - management of Power BI
    

## 5\. Answers:

A data analyst uses appropriate visuals to help business decision makers gain deep and meaningful insights from data.

An optimized and tuned semantic model performs better and provides a better data analysis experience.

A key benefit of data analysis is the ability to gain valuable insights from a business's data assets to make timely and optimal business decisions.

## **Learning objectives**

In this module, you'll:

* Learn about the roles in data.
    
* Learn about the tasks of a data analyst.
    

---

# II. Module 2 Get started building with Power BI

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 2/17 | Get started building with Power BI |

![](https://learn.microsoft.com/en-us/training/achievements/get-started-power-bi.svg)

## **1\. Introduction**

**Microsoft Power BI** is a complete reporting solution that offers data preparation, data visualization, distribution, and management through development tools and an online platform.

Use Power BI to create visually stunning, interactive reports requiring complex data modeling & to serve as the analytics and decision engine.

## **2\. Use Power BI**

Power BI Desktop - development tool available to data analysts and other report creators.  
Power BI service - allows you to organize, manage, and distribute your reports and other Power BI items, create high-level dashboards that drill down to reports.

The flow of Power BI is:

1. Connect to data with Power BI Desktop.
    
2. Transform in Power Query and model data with Power BI Desktop.
    
3. Create visualizations and reports with Power BI Desktop.
    
4. Publish report to Power BI service.
    
5. Distribute and manage reports in the Power BI service.
    

## **3\. Building blocks of Power BI**

The building blocks of Power BI are **semantic models** and **visualizations**.

semantic model - consists of all connected data, transformations, relationships, and calculations.

## **4\. Tour and use the Power BI service**

**Workspaces** are the foundation of the Power BI service.

Distribute content - Apps are the ideal sharing solution within any organization.

Refresh a semantic model - configure scheduled refreshes of your semantic models in the Power BI service.

## 5\. Answers:

The Power BI service lets you view and interact with reports and dashboards, but doesn't let you shape data.  
Without a semantic model, you can't create visualizations, and reports are made up of visualizations.

An app is a collection of ready-made visuals, pre-arranged in dashboards and reports. You can get apps that connect to many online services from the AppSource.

## **6\. Summary**

Microsoft Power BI offers a complete data analytics solution that includes data preparation, visualization, and distribution.

**Semantic models** and **visualizations** are the building blocks of Power BI.

The flow and components of Power BI include:

* **Power BI Desktop** for creating semantic models and reports with visualizations.
    
* **Power BI service** for creating dashboards from published reports and distributing content with apps.
    
* **Power BI Mobile** for on-the-go access to the Power BI service content, designed for mobile.
    

By using Power BI, you can make data-informed decisions across your organization.

## **Learning objectives**

In this module, you'll learn:

* How Power BI services and applications work together.
    
* Explore how Power BI can make your business more efficient.
    
* How to create compelling visuals and reports.
    

---

# III. Module 3 **Get data in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 3/17 | **Get data in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/get-data.svg)

You'll learn how to retrieve data from a variety of data sources, including Microsoft Excel, relational databases, and NoSQL data stores.

You'll also learn how to improve performance while retrieving data.

# **1\. Introduction**

create a suite of reports that are dependent on data in several different locations.

This module will focus on the first step of getting the data from the different data sources and importing it into Power BI by using Power Query.

![](https://learn.microsoft.com/en-us/training/modules/get-data/media/1-data-source-scenario-c.png#lightbox)

## **2\. Get data from files**

A flat file is a type of file that has only one data table and every row of data is in the same structure.

The file doesn't contain hierarchies. Likely, you're familiar with the most common types of flat files, which are comma-separated values (.csv) files, delimited text (.txt) files, and fixed width files.

Another type of file would be the output files from different applications, like Microsoft Excel workbooks (.xlsx).

Change the source file - Data source settings.

## **3\. Get data from relational data sources**

SQL Server.

Change data source settings - Power BI /Home tab, select Transform data, and then select the Data source settings option.

Write an SQL statement - SQL is beneficial because it allows you to load only the required set of data by specifying exact columns and rows in your SQL statement and then importing them into your semantic model. You can also join different tables, run specific calculations, create logical statements, and filter data in your SQL query.

It's a best practice to avoid doing this directly in Power BI. Instead, consider writing a query like this in a view.

A view is an object in a relational database, similar to a table. Views have rows and columns, and can contain almost every operator in the SQL language.

If Power BI uses a view, when it retrieves data, it participates in query folding, a feature of Power Query. Query folding will be explained later, but in short, Power Query will optimize data retrieval according to how the data is being used later.

## **4\. Create dynamic reports with parameters**

Creating dynamic reports allows you to give users more power over the data that is displayed in your reports; they can change the data source and filter the data by themselves.

Power Query Editor / Home tab, select Manage parameters &gt; New parameter.

### **5\. Create dynamic reports for multiple values**

To accommodate multiple values at a time, you first need to create a Microsoft Excel worksheet that has a table consisting of one column that contains the list of values.

## **6\. Get data from a NoSQL database**

A NoSQL database (also referred to as non-SQL, not only SQL or *non-relational*) is a flexible type of database that doesn't use tables to store data.

If you're working with data stored in JSON format, it's often necessary to extract and normalize the data first. This is because JSON data is often stored in a nested or unstructured format, which makes it difficult to analyze or report on directly.

## **7\. Get data from online services**

To support their daily operations, organizations frequently use a range of software applications, such as SharePoint, OneDrive, Dynamics 365, Google Analytics and so on. These applications produce their own data. Power BI can combine the data from multiple applications to produce more meaningful insights and reports.

## **8\. Select a storage mode**

business requirements are satisfied when you're importing data into Power BI.

However, sometimes there may be security requirements around your data that make it impossible to directly import a copy. Or your semantic models may simply be too large and would take too long to load into Power BI, and you want to avoid creating a performance bottleneck.

Power BI solves these problems by using the DirectQuery storage mode, which allows you to query the data in the data source directly and not import a copy into Power BI. DirectQuery is useful because it ensures you're always viewing the most recent version of the data.

The three different types of storage modes you can choose from:

* Import -
    
    * create a local Power BI copy of your semantic models from your data source, use all Power BI service features with this storage mode,
        
    * including Q&A and Quick Insights,
        
    * Data refreshes can be scheduled or on-demand.
        
* DirectQuery
    
    * useful when you don't want to save local copies of your data because your data won't be cached,
        
    * you can query the specific tables that you'll need by using native Power BI queries,
        
    * Essentially, you're creating a direct connection to the data source,
        
    * ensures that you're always viewing the most up-to-date data, and that all security requirements are satisfied,
        
    * Additionally, this mode is suited for when you have large semantic models to pull data from. Instead of slowing down performance by having to load large amounts of data into Power BI, you can use DirectQuery to create a connection to the source, solving data latency issues as well.
        
* Dual (Composite)
    
    * In Dual mode, you can identify some data to be directly imported and other data that must be queried. Any table that is brought in to your report is a product of both Import and DirectQuery modes.
        
    * Using the Dual mode allows Power BI to choose the most efficient form of data retrieval.
        

## **9\. Get data from Azure Analysis Services**

Azure Analysis Services is a fully managed platform as a service (PaaS) that provides enterprise-grade semantic models in the cloud.

You can use advanced mashup and modeling features to combine data from multiple data sources, define metrics, and secure your data in a single, trusted tabular semantic model.

The semantic model provides an easier and faster way for users to perform ad hoc data analysis using tools like Power BI.

Notable differences between Azure Analysis Services and SQL Server are:

* Analysis Services models have calculations already created.
    
* If you donâ€™t need an entire table, you can query the data directly. Instead of using Transact-SQL (T-SQL) to query the data, like you would in SQL Server, you can use multi-dimensional expressions (MDX) or data analysis expressions (DAX).
    

## **10\. Fix performance issues**

Occasionally, organizations will need to address performance issues when running reports.

Power BI provides the Performance Analyzer tool to help fix problems and streamline the process.

### **i. Optimize performance in Power Query**

The performance in Power Query depends on the performance at the data source level.

The variety of data sources that Power Query offers is wide, and the performance tuning techniques for each source are equally wide.

For instance, if you extract data from a Microsoft SQL Server, you should follow the performance tuning guidelines for the product. Good SQL Server performance tuning techniques include index creation, hardware upgrades, execution plan tuning, and data compression.

These topics are beyond the scope here, and are covered only as an example to build familiarity with your data source and reap the benefits when using Power BI and Power Query.

Power Query takes advantage of good performance at the data source through a technique called Query Folding.

#### 1\. Query folding

*Query folding* is the process by which the transformations and edits that you make in Power Query Editor are simultaneously tracked as native queries, or simple **Select** SQL statements, while you're actively making transformations.

The reason for implementing this process is to ensure that these transformations can take place in the original data source server and don't overwhelm Power BI computing resources.

You can use Power Query to load data into Power BI. Then use Power Query Editor to transform your data, such as renaming or deleting columns, appending, parsing, filtering, or grouping your data.

Consider a scenario where youâ€™ve renamed a few columns in the Sales data and merged a city and state column together in the â€œcity stateâ€ format. Meanwhile, the query folding feature tracks those changes in native queries. Then, when you load your data, the transformations take place independently in the original source, this ensures that performance is optimized in Power BI.

The benefits to query folding include:

* **More efficiency in data refreshes and incremental refreshes.** When you import data tables by using query folding, Power BI is better able to allocate resources and refresh the data faster because Power BI doesn't have to run through each transformation locally.
    
* **Automatic compatibility with DirectQuery and Dual storage modes.** All DirectQuery and Dual storage mode data sources must have the back-end server processing abilities to create a direct connection, which means that query folding is an automatic capability that you can use. If all transformations can be reduced to a single **Select** statement, then query folding can occur.
    

> If all transformations can be reduced to a single **Select** statement, then query folding can occur.

Native queries aren't possible for the following transformations:

* Adding an index column
    
* Merging and appending columns of different tables with two different sources
    
* Changing the data type of a column
    

A good guideline to remember is that if you can translate a transformation into a **Select** SQL statement, which includes operators and clauses such as GROUP BY, SORT BY, WHERE, UNION ALL, and JOIN, you can use query folding.

While query folding is one option to optimize performance when retrieving, importing, and preparing data, another option is query diagnostics.

### **ii. Query diagnostics**

Another tool that you can use to study query performance is *query diagnostics*. You can determine what bottlenecks may exist while loading and transforming your data, refreshing your data in Power Query, running SQL statements in Query Editor, and so on.

This tool is useful when you want to analyze performance on the Power Query side for tasks such as loading semantic models, running data refreshes, or running other transformative tasks.

### **iii. Other techniques to optimize performance**

Other ways to optimize query performance in Power BI include:

* **Process as much data as possible in the original data source.** Power Query and Power Query Editor allow you to process the data; however, the processing power that is required to complete this task might lower performance in other areas of your reports. Generally, a good practice is to process, as much as possible, in the native data source.
    
* **Use native SQL queries.** When using DirectQuery for SQL databases, such as the case for our scenario, make sure that you aren't pulling data from stored procedures or common table expressions (CTEs).
    
* **Separate date and time, if bound together.** If any of your tables have columns that combine date and time, make sure that you separate them into distinct columns before importing them into Power BI. This approach will increase compression abilities.
    

## **11\. Resolve data import errors**

While importing data into Power BI, you may encounter errors resulting from factors such as:

* Power BI imports from numerous data sources.
    
* Each data source might have dozens (and sometimes hundreds) of different error messages.
    
* Other components can cause errors, such as hard drives, networks, software services, and operating systems.
    
* Data often can't comply with any specific schema.
    

The following sections cover some of the more common error messages that you might encounter in Power BI.

### **i. Query timeout expired**

Relational source systems often have many people who are concurrently using the same data in the same database. Some relational systems and their administrators seek to limit a user from monopolizing all hardware resources by setting a query timeout. These timeouts can be configured for any timespan, from as little as five seconds to as much as 30 minutes or more.

For instance, if youâ€™re pulling data from your organizationâ€™s SQL Server, you might see the error shown in the following figure.

[![Screenshot of the data import errors for query timeout.](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-data-import-query-timeout-ss.png align="left")](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-data-import-query-timeout-ss.png#lightbox)

### **ii. Power BI Query Error: Timeout expired**

This error indicates that youâ€™ve pulled too much data according to your organizationâ€™s policies. Administrators incorporate this policy to avoid slowing down a different application or suite of applications that might also be using that database.

You can resolve this error by pulling fewer columns or rows from a single table. While you're writing SQL statements, it might be a common practice to include groupings and aggregations. You can also join multiple tables in a single SQL statement. Additionally, you can perform complicated subqueries and nested queries in a single statement. These complexities add to the query processing requirements of the relational system and can greatly elongate the time of implementation.

If you need the rows, columns, and complexity, consider taking small chunks of data and then bringing them back together by using Power Query. For instance, you can combine half the columns in one query and the other half in a different query. Power Query can merge those two queries back together after you're finished.

### **iii. We couldn't find any data formatted as a table**

Occasionally, you may encounter the â€œWe couldnâ€™t find any data formatted as a tableâ€ error while importing data from Microsoft Excel. Fortunately, this error is self-explanatory. Power BI expects to find data formatted as a table from Excel. The error even tells you the resolution. Perform the following steps to resolve the issue:

1. Open your Excel workbook, and highlight the data that you want to import.
    
2. Press the **Ctrl-T** keyboard shortcut. The first row will likely be your column headers.
    
3. Verify that the column headers reflect how you want to name your columns. Then, try to import data from Excel again. This time, it should work.
    
    [![Screenshot of the Power B I Excel error: We couldn't find any data formatted as a table.](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-format-as-table-excel-ss.png align="left")](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-format-as-table-excel-ss.png#lightbox)
    

### **iv. Couldn't find file**

While importing data from a file, you may get the "Couldn't find file" error.

[![Screenshot of the Could not find file error screen.](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-file-location-ss.png align="left")](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-file-location-ss.png#lightbox)

Usually, this error is caused by the file moving locations or the permissions to the file changing. If the cause is the former, you need to find the file and change the source settings.

1. Open Power Query by selecting the **Transform Data** button in Power BI.
    
2. Highlight the query that is creating the error.
    
3. On the left, under **Query Settings**, select the gear icon next to **Source**.
    
    [![Screenshot of the query settings pane with Source selected under Applied Steps.](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-query-changes-ss.png align="left")](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-query-changes-ss.png#lightbox)
    
4. Change the file location to the new location.
    
    [![Screenshot of the file location settings pane.](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-file-location-new-location-ss.png align="left")](https://learn.microsoft.com/en-us/training/modules/get-data/media/9-file-location-new-location-ss.png#lightbox)
    

### **iv. Data type errors**

Sometimes, when you import data into Power BI, the columns appear blank. This situation happens because of an error in interpreting the data type in Power BI. The resolution to this error is unique to the data source. For instance, if you're importing data from SQL Server and see blank columns, you could try to convert to the correct data type in the query.

Instead of using this query:

`SELECT CustomerPostalCode FROM Sales.Customers`

Use this query:

`SELECT CAST(CustomerPostalCode as varchar(10)) FROM Sales.Customers`

By specifying the correct type at the data source, you eliminate many of these common data source errors.

You may encounter different types of errors in Power BI that are caused by the diverse data source systems where your data resides.

## **12\. Exercise - Prepare data in Power BI Desktop**

Get Data in Power BI Desktop

Lab story

This lab is designed to introduce you to Power BI Desktop application and how to connect to data and how to use data preview techniques to understand the characteristics and quality of the source data. The learning objectives are:

* Open Power BI Desktop
    
* Connect to different data sources
    
* Preview source data with Power Query
    
* Use data profiling features in Power Query
    

## **i. Get data from SQL Server**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712293898196/d8665311-8a1c-4691-86c7-5a22cb46e839.png)

### **ii. Preview Data in Power Query Editor**

Observed:

#### DimEmployee Query

table - Notice that the last five columns contain Table or Value links.

These five columns represent relationships to other tables in the database.

They can be used to join tables together. **Youâ€™ll join tables in the Load Transformed Data in Power BI Desktop lab.**

Column Quality for Position column - shows 94% empty.

Column Distribution for EmployeeKey column

*When the distinct and unique counts are the same, it means the column contains unique values.*

*When modeling, itâ€™s important that some model tables have unique columns. These unique columns can be used to create one-to-many relationships, which youâ€™ll do in the****Model Data in Power BI Desktop****lab.*

[![Column distribution showing 296 distinct, 296 unique values](https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst/Instructions/Labs/Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image26.png)](https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst/Instructions/Labs/Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image26.png)

#### DimReseller query

Column Profile for BusinessType column header - Notice the data quality issue: there are two labels for warehouse (Warehouse, and the misspelled Ware House) - Y**ouâ€™ll apply a transformation to relabel these five rows in the Load Transformed Data in Power BI Desktop lab.**

#### DimSalesTerritory query

**In the Model Data in Power BI Desktop lab, youâ€™ll create a hierarchy to support analysis at region, country, or group level.**

#### FactResellerSales query

column quality for the TotalProductCost column, and notice that 8% of the rows are empty - Missing TotalProductCost column values is a data quality issue. **To address the issue, in the Load Transformed Data in Power BI Desktop lab, youâ€™ll apply transformations to fill in missing values by using the product standard cost, which is stored in the related DimProduct table.**

## **iii. Get data from a CSV file**

ResellerSalesTargets query

Repeat the steps to create a query based on the **D:\\Allfiles\\Resources\\ColorFormats.csv** file.

Save / apply later.

# **13\. Check your knowledge**

T-SQL is the query language that you would use for SQL Server.

You're creating a Power BI report with data from an Azure Analysis Services MDX Cube. When the data refreshes in the cube, you would like to see it immediately in the Power BI report. How should you connect? - Live connection.

What can you do to improve performance when you're getting data in Power BI?Always use the least amount of data needed for your project.

# **14\. Summary**

In this module, you learned about pulling data from many different data sources and into Power BI.

You can pull data from files, relational databases, Azure Analysis Services, cloud-based applications, websites, and more.

Retrieving data from different data sources requires treating each data source differently. For instance, Microsoft Excel data should be pulled in from an Excel table. Relational databases often have query timeouts.

You can connect to SQL Server Analysis Services with Connect live, which allows you to see data changes in real-time.

It's important to select the correct storage mode for your data.

Do you require that visuals interact quickly but donâ€™t mind possibly refreshing the data when the underlying data source changes?

If so, select Import to import data into Power BI.

If you prefer to see updates to data as soon as they happen at the cost of interactivity performance, then choose Direct Query for your data instead.

In addition, you learned how to solve performance problems and data import errors.

You learned that Power BI gives you tooling to identify where performance problems may exist. Data import errors can be alarming at first, but you can see that the resolution is easily implemented.

## **Learning objectives**

By the end of this module, you'll be able to:

* Identify and connect to a data source
    
* Get data from a relational database, like Microsoft SQL Server
    
* Get data from a file, like Microsoft Excel
    
* Get data from applications
    
* Get data from Azure Analysis Services
    
* Select a storage mode
    
* Fix performance issues
    
* Resolve data import errors
    

---

# IV. Module 4 Clean, transform, and load data in Power BI

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 4/17 | Clean, transform, and load data in Power BI |

![](https://learn.microsoft.com/en-us/training/achievements/clean-transform-and-load-data-in-power-bi.svg)

Power Query has an incredible number of features that are dedicated to helping you clean and prepare your data for analysis.

You'll learn how to simplify a complicated model, change data types, rename objects, and pivot data.

You'll also learn how to profile columns so that you know which columns have the valuable data that youâ€™re seeking for deeper analytics.

# **1\. Introduction**

When examining the data, you discover several issues, including:

* A column called **Employment status** only contains numerals.
    
* Several columns contain errors.
    
* Some columns contain null values.
    
* The customer ID in some columns appears as if it was duplicated repeatedly.
    
* A single address column has combined street address, city, state, and zip code.
    

Clean data has the following advantages:

* Measures and columns produce more accurate results when they perform aggregations and calculations.
    
* Tables are organized, where users can find the data in an intuitive manner.
    
* Duplicates are removed, making data navigation simpler. It will also produce columns that can be used in slicers and filters.
    
* A complicated column can be split into two, simpler columns. Multiple columns can be combined into one column for readability.
    
* Codes and integers can be replaced with human readable values.
    

## **2\. Shape the initial data**

Power Query Editor in Power BI Desktop allows you to shape (transform) your imported data.

You can accomplish actions such as

* renaming columns or tables,
    
* changing text to numbers,
    
* removing rows,
    
* setting the first row as headers,
    
* and much more.
    

It is important to shape your data to ensure that it meets your needs and is suitable for use in reports.

## **i. Get started with Power Query Editor**

Removing columns at an early stage in the process rather than later is best, especially when you have established relationships between your tables. Removing unnecessary columns will help you to focus on the data that you need and help improve the overall performance of your Power BI Desktop semantic models and reports.

## **3\. Simplify the data structure**

Rename a query

Replace values

Replace null values

Remove duplicates

## **4\. Evaluate and change column data types**

Implications of incorrect data types

Incorrect data types will prevent you from creating certain calculations, deriving hierarchies, or creating proper relationships with other tables.

For example, if you try to calculate the Quantity of Orders YTD, you'll get the following error stating that the OrderDate column data type isn't Date, which is required in time-based calculations.

Another issue with having an incorrect data type applied on a date field is the inability to create a date hierarchy, which would allow you to analyze your data on a yearly, monthly, or weekly basis.

Change the column data type in Power Query Editor

the change that you make to the column data type is saved as a programmed step. This step is called Changed Type

## **5\. Combine multiple tables into a single table**

You can combine tables into a single table in the following circumstances:

* Too many tables exist, making it difficult to navigate an overly complicated semantic model.
    
* Several tables have a similar role.
    
* A table has only a column or two that can fit into a different table.
    
* You want to use several columns from different tables in a custom column.
    

You can combine the tables in two different ways: merging and appending.

### **i. Append queries**

When you append queries, you'll be adding rows of data to another table or query.

For example, you could have two tables, one with 300 rows and another with 100 rows, and when you append queries, you'll end up with 400 rows.

### **ii. Merge queries**

When you merge queries, you'll be adding columns from one table (or query) into another. To merge two tables, you must have a column that is the key between the two tables.

This process is similar to the JOIN clause in SQL.

## **6\. Profile data in Power BI**

Profiling data is about studying the nuances of the data: determining anomalies, examining and developing the underlying data structures, and querying data statistics such as row counts, value distributions, minimum and maximum values, averages, and so on.

### **i. Find data anomalies and data statistics**

**Column quality** shows you the percentages of data that is valid, in error, and empty.

**Column profile** gives you a more in-depth look into the statistics within the columns for the first 1,000 rows of data.

**Column distribution** shows you the distribution of the data within the column and the counts of distinct and unique values, both of which can tell you details about the data counts.

## **7\. Use Advanced Editor to modify M code**

Each time you shape data in Power Query, you create a step in the Power Query process. Those steps can be reordered, deleted, and modified where it makes sense.

## **8\. Exercise - Load data in Power BI Desktop**

Load Transformed Data in Power BI Desktop

Lab story

In this lab, youâ€™ll use data cleansing and transformation techniques to start shaping your data model.

Youâ€™ll then apply the queries to load each as a table to the data model.

In this lab you learn how to:

* Apply various transformations
    
* Load queries to the data model
    

### **i. Configure the Salesperson query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712480218127/0e238424-d2d5-4a29-ab4f-8658e77aa89b.png)

### **ii. Configure the SalespersonRegion query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712481165402/b066e26a-233a-4a92-9b0a-378692d601a8.png)

### **iii. Configure the Product query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712481752856/ed5e6a86-9b59-4ac1-85ad-c52abe81b403.png)

### **iv. Configure the Reseller query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712481971964/dacf771a-87fd-4aad-b816-c59d62ca185f.png)

### **v. Configure the Region query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712482180102/4c4fc606-d703-4008-ab0d-add0e9d4cb36.png)

### **vi. Configure the Sales query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712482671890/653486da-969d-4ad5-be46-37adee1969f6.png)

### **vii. Configure the Targets query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712483276542/8838f1cb-f29d-47ea-b361-e7717bdbc99d.png)

### **viii. Configure the ColorFormats query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712483337624/8714c73c-f0ea-495d-94c6-dc0ac745ecfb.png)

### **ix. Update the Product query**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712483533905/5ee0980e-00ce-4638-a9cb-004380e53f59.png)

### **x. Update the ColorFormats query**

In the **Query Properties** window, uncheck the **Enable Load To Report** checkbox.

*Disabling the load means it will not load as a table to the data model. This is done because the query was merged with the****Product****query, which is enabled to load to the data model.*

### **xi. Finish up**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712485872290/8ec23d3a-e1e5-4287-b591-31be54604396.png)

## **9\. Check your knowledge**

What is a risk of having null values in a numeric column?

AVERAGE takes the total and divides by the number of non-null values. If NULL is synonymous with zero in the data, the average will be different from the accurate average.

If you have two queries that have different data but the same column headers, and you want to combine both tables into one query with all the combined rows, which operation should you perform?

Append will take two tables and combine it into one query. The combined query will have more rows while keeping the same number of columns.

Which of the following selections aren't best practices for naming conventions in Power BI?

Abbreviations lead to confusion because they're often overused or not universally agreed on.

## 10\. Summary

This module explained how you can take data that is difficult to read, build calculations on, and discover and make it simpler for report authors and others to use.

Additionally, you learned how to combine queries so that they were fewer in number, which makes data navigation more streamlined.

You also replaced renamed columns into a human readable form and reviewed good naming conventions for objects in Power BI.

## **Learning objectives**

By the end of this module, youâ€™ll be able to:

* Resolve inconsistencies, unexpected or null values, and data quality issues.
    
* Apply user-friendly value replacements.
    
* Profile data so you can learn more about a specific column before using it.
    
* Evaluate and transform column data types.
    
* Apply data shape transformations to table structures.
    
* Combine queries.
    
* Apply user-friendly naming conventions to columns and queries.
    
* Edit M code in the Advanced Editor.
    

---

# V. Module 5 **Design a semantic model in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 5/17 | **Design a semantic model in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/design-a-data-model-in-power-bi.svg)

Building a great semantic model is about simplifying the disarray.

A star schema is one way to simplify a semantic model.

You will also learn about why choosing the correct data granularity is important for performance and usability of your Power BI reports.

Finally, you learn about improving performance with your Power BI semantic models.

## 1\. Introduction

A good semantic model offers the following benefits:

* Data exploration is faster.
    
* Aggregations are simpler to build.
    
* Reports are more accurate.
    
* Writing reports takes less time.
    
* Reports are easier to maintain in the future.
    

Typically, a smaller semantic model is composed of fewer tables and fewer columns in each table that the user can see.

To summarize, you should aim for simplicity when designing your semantic models.

### **i. Star schemas**

**Now that you have learned about the relationships that make up the data schema, you are able to explore a specific type of schema design, the star schema, which is optimized for high performance and usability.**

### **ii. Fact tables**

**Fact tables** contain observational or event data values: sales orders, product counts, prices, transactional dates and times, and quantities.

> Fact tables can contain several repeated values.

For example, one product can appear multiple times in multiple rows, for different customers on different dates. These values can be aggregated to create visuals.

For instance, a visual of the total sales orders is an aggregation of all sales orders in the fact table.

With fact tables, it is common to see columns that are filled with numbers and dates. The numbers can be units of measurement, such as sale amount, or they can be keys, such as a customer ID. The dates represent time that is being recorded, like order date or shipped date.

> The Sales table contains the sales order values, which can be aggregated, it is considered a fact table.

### **iii. Dimension tables**

**Dimension tables** contain the details about the data in fact tables: products, locations, employees, and order types.

These tables are connected to the fact table through key columns.

> Dimension tables are used to filter and group the data in fact tables.

The fact tables, on the other hand, contain the measurable data, such as sales and revenue, and each row represents a unique combination of values from the dimension tables.

For the total sales orders visual, you could group the data so that you see total sales orders by product, in which product is data in the dimension table.

Fact tables are much larger than dimension tables because numerous events occur in fact tables, such as individual sales.

Dimension tables are typically smaller because you are limited to the number of items that you can filter and group on.

For instance, a year contains only so many months, and the United States are composed of only a certain number of states.

> The Employee table contains the specific employee name, which filters the sales orders, so it would be a dimension table.

### Note:

> The Sales table contains the sales order values, which can be aggregated, it is considered a fact table.

> The Employee table contains the specific employee name, which filters the sales orders, so it would be a dimension table

> Star schemas and the underlying semantic model are the foundation of organized reports; the more time you spend creating these connections and design, the easier it will be to create and maintain reports.

## 2\. Work with tables

This process of formatting and configuring tables can also be done in Power Query.

## 3\. Create a date table

During report creation in Power BI, a common business requirement is to make calculations based on date and time. Organizations want to know how their business is doing over months, quarters, fiscal years, and so on.

You can create a common date table that can be used by multiple tables.

### **i. Create a common date table**

Ways that you can build a common date table are:

* Source data
    
* DAX
    
* Power Query
    

### **ii. DAX**

You can use the Data Analysis Expression (DAX) functions CALENDARAUTO() or CALENDAR() to build your common date table.

The CALENDARAUTO() function returns a contiguous, complete range of dates that are automatically determined from your semantic model.

The starting date is chosen as the earliest date that exists in your semantic model, and the ending date is the latest date that exists in your semantic model plus data that has been populated to the fiscal month that you can choose to include as an argument in the CALENDARAUTO() function.

```sql
Dates  = CALENDAR(DATE(2011, 5, 31), DATE(2022, 12, 31))
```

```sql
Year = YEAR(Dates[Date])
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712474368697/7fba5578-5976-48db-b3fb-d098ed3a8e87.png)

### iii. **Power Query**

You can use M-language, the development language that is used to build queries in Power Query, to define a common date table.

```sql
= List.Dates(
#date(2011,05,31), // start date
365*10, //Dates for everyday for the next 10 years
#duration(1,0,0,0) //Specifies duration of the period 1 = days, 0 = hours, 0 = minutes, 0 = seconds
)
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712475164272/13e4d88f-79fb-496b-8b17-61ed2a49d012.png)

## 4\. Work with dimensions

When building a star schema, you will have dimension and fact tables.

Fact tables contain information about events such as sales orders, shipping dates, resellers, and suppliers.

Dimension tables store details about business entities, such as products or time, and are connected back to fact tables through a relationship.

You can use hierarchies as one source to help you find detail in dimension tables. These hierarchies form through natural segments in your data.

For instance, you can have a hierarchy of dates in which your dates can be segmented into years, months, weeks, and days.

Hierarchies are useful because they allow you to drill down into the specifics of your data instead of only seeing the data at a high level.

### **i. Hierarchies**

To create a hierarchy, go to the **Fields** pane on Power BI and then right-click the column that you want the hierarchy for. Select **New hierarchy**,

Parent-child hierarchy

Flatten parent-child hierarchy

The process of viewing multiple child levels based on a top-level parent is known as *flattening the hierarchy*.

In this process, you are creating multiple columns in a table to show the hierarchical path of the parent to the child in the same record. You will use PATH(), a simple DAX function that returns a text version of the managerial path for each employee, and PATHITEM() to separate this path into each level of managerial hierarchy.

```sql
Path = PATH(Employee[Employee ID], Employee[Manager ID])
```

To flatten the hierarchy, you can separate each level by using the PATHITEM function.  
To view all three levels of the hierarchy separately, you can create four columns in the same way that you did previously, by entering the following equations. You will use the PATHITEM function to retrieve the value that resides in the corresponding level of your hierarchy.

* *Level 1 = PATHITEM(Employee\[Path\],1)*
    
* *Level 2 = PATHITEM(Employee\[Path\],2)*
    
* *Level 3 = PATHITEM(Employee\[Path\],3)*
    

### **ii. Role-playing dimensions**

Role-playing dimensions have multiple valid relationships with fact tables, meaning that the same dimension can be used to filter multiple columns or tables of data. As a result, you can filter data differently depending on what information you need to retrieve.

Calendar is the dimension table, while Sales and Order are fact tables.

The dimension table has two relationships: one with Sales and one with Order.

This example is of a role-playing dimension because the Calendar table can be used to group data in both Sales and Order.

If you wanted to build a visual in which the Calendar table references the Order and the Sales tables, the Calendar table would act as a role-playing dimension.

## 5\. Define data granularity

Data granularity is the detail that is represented within your data, meaning that the more granularity your data has, the greater the level of detail within your data.

## 6\. Work with relationships and cardinality

Power BI has the concept of *directionality* to a relationship.

This directionality plays an important role in filtering data between multiple tables.

### **i. Relationships**

The following are different types of relationships that you'll find in Power BI.

Many-to-one `(*:1)` or one-to-many `(1: *)` relationship

* Describes a relationship in which you have many instances of a value in one column that are related to only one unique corresponding instance in another column.
    
* Describes the directionality between fact and dimension tables.
    
* Is the most common type of directionality and is the Power BI default when you are automatically creating relationships.
    

One-to-one (1:1) relationship:

* Describes a relationship in which only one instance of a value is common between two tables.
    
* Requires unique values in both tables.
    
* Is not recommended because this relationship stores redundant information and suggests that the model is not designed correctly. It is better practice to combine the tables.
    

Many-to-many (*.*) relationship:

* Describes a relationship where many values are in common between two tables.
    
* Does not require unique values in either table in a relationship.
    
* Is not recommended; a lack of unique values introduces ambiguity and your users might not know which column of values is referring to what.
    

### **ii. Cross-filter direction**

Data can be filtered on one or both sides of a relationship.

With a **single cross-filter direction**:

* Only one table in a relationship can be used to filter the data. For instance, Table 1 can be filtered by Table 2, but Table 2 cannot be filtered by Table 1.
    

### **Note: \*\***

> Follow the direction of the arrow on the relationship between your tables to know which direction the filter will flow. You typically want these arrows to point to your fact table.

* For a one-to-many or many-to-one relationship, the cross-filter direction will be from the "one" side, meaning that the filtering will occur in the table that has many values.
    

With **both cross-filter directions** or **bi-directional cross-filtering**:

* One table in a relationship can be used to filter the other. For instance, a dimension table can be filtered through the fact table, and the fact tables can be filtered through the dimension table.
    
* You might have lower performance when using bi-directional cross-filtering with many-to-many relationships.
    

### **iii. Cardinality and cross-filter direction**

For one-to-one relationships, the only option that is available is bi-directional cross-filtering.

For many-to-many relationships, you can choose to filter in a single direction or in both directions by using bi-directional cross-filtering.

### iv. Create many-to-many relationships

## 7\. Resolve modeling challenges

When you are creating these relationships, a common pitfall that you might encounter are circular relationships.

### i. Relationship dependencies

## 8\. Exercise - Model data in Power BI Desktop

Design a Data Model in Power BI

**Lab story**

It will involve creating relationships between tables, and then configuring table and column properties to improve the friendliness and usability of the data model.

Youâ€™ll also create hierarchies and create quick measures.

In this lab you learn how to:

* Create model relationships
    
* Configure table and column properties
    
* Create hierarchies
    

### i. Create model relationships

1. You can interpret the cardinality that is represented by the **1** and **(\*)** indicators.
    
2. Filter direction is represented by the arrow head.
    
3. A solid line represents an active relationship; a dashed line represents an inactive relationship.
    
4. Hover the cursor over the relationship to highlight the related columns.
    

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712581134164/2f6d9550-3f33-484c-9475-a74a0150f556.png)

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712581145370/d513062b-b8b4-429e-8c2a-643b62a7a975.png)

### ii. Configure Tables

### iii. Configure the Product table

To organize columns into a **display folder,** in the Data pane, first select the Background Color Format column.

While pressing the Ctrl key, select the Font Color Format column.

In the Properties pane, in the Display Folder box, enter Formatting.

Display folders are a great way to declutter tablesâ€”especially for tables that comprise many fields. Theyâ€™re logical presentation only.

### iv. Configure the Region table

In the Properties pane, expand the Advanced section (at the bottom of the pane), and then in the Data Category dropdown list, select Country/Region.

Data categorization can provide hints to the report designer. In this case, categorizing the column as country or region provides more accurate information to Power BI when it renders a map visualization.

### v. Configure the Reseller table

### vi. Configure the Sales table

### vii. Bulk update properties

In the Properties pane, slide the Is Hidden property to Yes.

The columns were hidden because theyâ€™re either used by relationships or will be used in row-level security configuration or calculation logic.

### viii. Review the Model Interface

1. In the **Data** pane, notice the following:
    
    * Columns, hierarchies and their levels are fields, which can be used to configure report visuals
        
    * Only fields relevant to report authoring are visible
        
    * The **SalespersonRegion** table isnâ€™t visibleâ€”because all of its fields are hidden
        
    * Spatial fields in the **Region** and **Reseller** table are adorned with a spatial icon
        
    * Fields adorned with the sigma symbol (Æ©) will summarize, by default
        
    * A tooltip appears when hovering the cursor over the **Sales | Cost** field
        

### ix. Review the model interface

To turn off auto/date time, Navigate to File &gt; Options and Settings &gt; Options &gt; Current File group, and select Data Load. In the **Time Intelligence** section, uncheck **Auto Date/Time**.

### x. Create Quick Measures

### xi. Create quick measures

```sql
Profit = 
SUM('Sales'[Sales]) - SUM('Sales'[Cost])
```

```sql
Profit Margin = 
DIVIDE([Profit], SUM('Sales'[Sales]))
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712585394106/ef9db81a-f209-47c0-af47-52cc00247e73.png)

### xii. Create a many-to-many relationship

### xiii. Relate the Targets table

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1712586280722/796b43cf-a93f-4f6e-9b48-8b1fbbf2e0c6.png)

## 9\. Check your knowledge

What does data granularity mean?

The level of detail in your data, meaning that higher granularity means more detailed data.

Data granularity refers to how finely or coarsely your data is divided or aggregated.

What is the difference between a fact table and a dimension table?

Fact tables contain observational data such as sales orders, employees, shipping dates, and so on, while dimension tables contain information about specific entities such as product IDs and dates.

Choose the best answer to explain relationship cardinality?

Cardinality is the measure of unique values in a table.

An example of high cardinality would be a Sales table as it has a high number of unique values.

## 10\. Summary

You have learned about modeling data in Power BI, which includes such topics as creating common date tables, learning about and configuring many-to-many relationships, resolving circular relationships, designing star schemas, and much more.

These skills are crucial to the Power BI practitioner's toolkit so that it is easier to build visuals and hand off your report elements to other teams. With this foundation, you now have the ability to explore the many nuances of the semantic model.

## **Learning objectives**

In this module, you will:

* Create common date tables
    
* Configure many-to-many relationships
    
* Resolve circular relationships
    
* Design star schemas
    

---

# VI. Module 6 **Add measures to Power BI Desktop models**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 6/17 |  |

![](https://learn.microsoft.com/en-us/training/achievements/add-measures-power-bi-desktop.svg)

i

---

# VII. Module 7 **Add calculated tables and columns to Power BI Desktop models**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 7/17 | **Add calculated tables and columns to Power BI Desktop models** |

![](https://learn.microsoft.com/en-us/training/achievements/dax-power-bi-add-calculated-tables.svg)

i

---

# VIII. Module 8 **Use DAX time intelligence functions in Power BI Desktop models**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 8/17 | **Use DAX time intelligence functions in Power BI Desktop models** |

![](https://learn.microsoft.com/en-us/training/achievements/use-dax-power-bi-desktop.svg)

---

# IX. Module 9 **Optimize a model for performance in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 9/17 | **Optimize a model for performance in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/optimize-model-power-bi.svg)

---

# X. Module 10 **Design Power BI reports**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 10/17 | **Design Power BI reports** |

![](https://learn.microsoft.com/en-us/training/achievements/power-bi-effective-reports.svg)

---

# XI. Module 11 **Configure Power BI report filters**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 11/17 | **Configure Power BI report filters** |

![](https://learn.microsoft.com/en-us/training/achievements/power-bi-effective-filters.svg)

---

# XII. Module 12 **Enhance Power BI report designs for the user experience**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 12/17 | **Enhance Power BI report designs for the user experience** |

![](https://learn.microsoft.com/en-us/training/achievements/power-bi-effective-user-experience.svg)

---

# XIII. Module 13 **Perform analytics in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 13/17 | **Perform analytics in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/perform-analytics-power-bi.svg)

---

# XIV. Module 14 **Create and manage workspaces in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 14/17 | **Create and manage workspaces in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/create-manage-workspaces-power-bi.svg)

---

# XV. Module 15 **Manage semantic models in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 15/17 | **Manage semantic models in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/manage-datasets-in-power-bi.svg)

---

# XVI. Module 16 **Create dashboards in Power BI**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 16/17 | **Create dashboards in Power BI** |

![](https://learn.microsoft.com/en-us/training/achievements/create-dashboards-power-bi.svg)

---

# XVI. Module 17 **Implement row-level security**

| Course | Microsoft Power BI Data Analyst |
| --- | --- |
| Module 17/17 | **Implement row-level security** |

![](https://learn.microsoft.com/en-us/training/achievements/row-level-security-power-bi.svg)

---

# Conclusion

Learning Objectives,

1. Discover data analysis
    
2. Get started building with Power BI
    
3. Get data in Power BI
    

# Source: Microsoft Power BI Data Analyst \[[Link](https://learn.microsoft.com/en-us/training/courses/pl-300t00)\]

# Author: Dheeraj.Yss

# Connect with me:

* [My Twitter](https://twitter.com/yssdheeraj)
    
* [My LinkedIn](https://www.linkedin.com/in/dheerajy1/)
    
* [My GitHub](https://github.com/dheerajy1)
    
* [My Hashnode](https://dheerajy1.hashnode.dev/)